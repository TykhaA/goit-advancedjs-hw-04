{"version":3,"file":"commonHelpers.js","sources":["../src/index.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\niziToast.settings({\n    timeout: 3000, \n    resetOnHover: true,\n    position: 'topRight',\n});\nconst elements = {\n    form: document.querySelector('.js-form'),\n    gallery: document.querySelector('.gallery'),\n    guard: document.querySelector('.js-guard')\n}\nlet photoCard = new SimpleLightbox('.photo-card a', {\n    captionDelay :'250'\n});\nconst options = {\n    rootMargin: '50px'\n}\nconst observer = new IntersectionObserver(handlerLoadMore, options);\nlet page = 1;\nlet value = \"\";\nfunction createMarkup(response) {\n    const markupData = response.data.hits.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `<div class=\"photo-card\">\n            <a href=\"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            </a>\n            <div class=\"info\">\n                <p class=\"info-item\">\n                    <b>Likes</b>\n                    <span>${likes}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Views</b>\n                    <span>${views}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Comments</b>\n                    <span>${comments}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Downloads</b>\n                    <span>${downloads}</span>\n                </p>\n            </div>\n         </div>`\n    }).join('');\n    elements.gallery.insertAdjacentHTML('beforeend', markupData);\n}\n\nelements.form.addEventListener('submit', handlerSearch);\nfunction handlerSearch(evt) {\n    evt.preventDefault();\n    \n    const { searchQuery } = evt.currentTarget.elements;\n    elements.gallery.innerHTML = '';\n    value = searchQuery.value;\n    if (value.trim() !== \"\") {\n        page = 1;\n        observer.unobserve(elements.guard);\n        serviceItems(value, page);\n        elements.form.reset();\n    } else {\n        iziToast.error({\n            message: `You need to fill thecorrect search.`,\n          });\n     }\n   \n}\nasync function getResponse(value, page){\n    try{\n        return await axios.get(`https://pixabay.com/api/?key=42309515-7c9611a24bfcb09e365820ed6&q=${value}&image_type=photo&orientation=horizontal&=true&per_page=40&page=${page}`);\n    }\n    catch(error) {\n        iziToast.error({\n            message: `Sorry, there are no images matching your search query. Please try again.`,\n        });\n    }\n}\nasync function serviceItems(value, page) {\n    const response = await getResponse(value, page);\n\n    if (response.data.hits.length === 0) {\n        iziToast.error({\n            message: `Sorry, there are no images matching your search query. Please try again.`,\n        });\n    } else {\n        createMarkup(response);\n        photoCard.refresh();\n        if (page <= response.data.total / 40 && page < 500) {\n            observer.observe(elements.guard)\n        } else {\n            observer.unobserve(elements.guard);\n            iziToast.info({\n                message: `We're sorry, but you've reached the end of search results.`,\n                });\n        }\n    }\n}\nfunction handlerLoadMore(entries) {\n    entries.forEach(entry => {\n        if (entry.isIntersecting) {\n            page += 1;\n            serviceItems(value, page);\n        }\n    })\n}"],"names":["iziToast","elements","photoCard","SimpleLightbox","options","observer","handlerLoadMore","page","value","createMarkup","response","markupData","webformatURL","largeImageURL","tags","likes","views","comments","downloads","handlerSearch","evt","searchQuery","serviceItems","getResponse","axios","entries","entry"],"mappings":"+vBAMAA,EAAS,SAAS,CACd,QAAS,IACT,aAAc,GACd,SAAU,UACd,CAAC,EACD,MAAMC,EAAW,CACb,KAAM,SAAS,cAAc,UAAU,EACvC,QAAS,SAAS,cAAc,UAAU,EAC1C,MAAO,SAAS,cAAc,WAAW,CAC7C,EACA,IAAIC,EAAY,IAAIC,EAAe,gBAAiB,CAChD,aAAc,KAClB,CAAC,EACD,MAAMC,EAAU,CACZ,WAAY,MAChB,EACMC,EAAW,IAAI,qBAAqBC,EAAiBF,CAAO,EAClE,IAAIG,EAAO,EACPC,EAAQ,GACZ,SAASC,EAAaC,EAAU,CAC5B,MAAMC,EAAaD,EAAS,KAAK,KAAK,IAAI,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IACtG;AAAA,uBACQL,CAAa;AAAA,4BACRD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,4BAK1BC,CAAK;AAAA;AAAA;AAAA;AAAA,4BAILC,CAAK;AAAA;AAAA;AAAA;AAAA,4BAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,4BAIRC,CAAS;AAAA;AAAA;AAAA,gBAIhC,EAAE,KAAK,EAAE,EACVjB,EAAS,QAAQ,mBAAmB,YAAaU,CAAU,CAC/D,CAEAV,EAAS,KAAK,iBAAiB,SAAUkB,CAAa,EACtD,SAASA,EAAcC,EAAK,CACxBA,EAAI,eAAc,EAElB,KAAM,CAAE,YAAAC,CAAa,EAAGD,EAAI,cAAc,SAC1CnB,EAAS,QAAQ,UAAY,GAC7BO,EAAQa,EAAY,MAChBb,EAAM,KAAM,IAAK,IACjBD,EAAO,EACPF,EAAS,UAAUJ,EAAS,KAAK,EACjCqB,EAAad,EAAOD,CAAI,EACxBN,EAAS,KAAK,SAEdD,EAAS,MAAM,CACX,QAAS,qCACrB,CAAW,CAGX,CACA,eAAeuB,EAAYf,EAAOD,EAAK,CACnC,GAAG,CACC,OAAO,MAAMiB,EAAM,IAAI,qEAAqEhB,CAAK,mEAAmED,CAAI,EAAE,CAC7K,MACY,CACTP,EAAS,MAAM,CACX,QAAS,0EACrB,CAAS,CACJ,CACL,CACA,eAAesB,EAAad,EAAOD,EAAM,CACrC,MAAMG,EAAW,MAAMa,EAAYf,EAAOD,CAAI,EAE1CG,EAAS,KAAK,KAAK,SAAW,EAC9BV,EAAS,MAAM,CACX,QAAS,0EACrB,CAAS,GAEDS,EAAaC,CAAQ,EACrBR,EAAU,QAAO,EACbK,GAAQG,EAAS,KAAK,MAAQ,IAAMH,EAAO,IAC3CF,EAAS,QAAQJ,EAAS,KAAK,GAE/BI,EAAS,UAAUJ,EAAS,KAAK,EACjCD,EAAS,KAAK,CACV,QAAS,4DACzB,CAAiB,GAGjB,CACA,SAASM,EAAgBmB,EAAS,CAC9BA,EAAQ,QAAQC,GAAS,CACjBA,EAAM,iBACNnB,GAAQ,EACRe,EAAad,EAAOD,CAAI,EAEpC,CAAK,CACL"}